<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Curso en Línea</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        Mi Curso en Línea
    </header>

    <nav>
        <a href="#">Inicio</a>
        <a href="#">Cursos</a>
        <a href="#">Registro</a>
    </nav>

    <section>
        <h1>Bienvenido a Mi Curso en Línea</h1>
        <p>Regístrate, marca tu asistencia y realiza tus pagos fácilmente.</p>

        <h2>Cursos Disponibles</h2>
        <div id="cursos-lista">
            <p>Cargando cursos...</p>
        </div>

        <h2>Registro de Usuario</h2>
        <form id="formRegistro">
            <input type="text" id="nombre" placeholder="Nombre completo" required>
            <input type="email" id="correo" placeholder="Correo electrónico" required>
            <button type="submit">Registrarse</button>
        </form>

        <h2>Control de Asistencia</h2>
        <form id="formAsistencia">
            <input type="email" id="correoAsistencia" placeholder="Correo electrónico" required>
            <button type="submit">Marcar asistencia</button>
        </form>

        <h2>Pagos</h2>
        <form id="formPagos">
            <input type="email" id="correoPago" placeholder="Correo electrónico" required>
            <select id="metodoPago">
                <option value="Visa">Visa/MasterCard</option>
                <option value="Yape">Yape</option>
                <option value="Plin">Plin</option>
                <option value="PayPal">PayPal</option>
            </select>
            <button type="submit">Pagar</button>
        </form>
    </section>

    <footer>
        © Mi Curso en Línea. Todos los derechos reservados.
    </footer>

    <script>
        async function cargarCursos() {
            const res = await fetch('/api/cursos');
            const cursos = await res.json();
            const listaDiv = document.getElementById('cursos-lista');
            listaDiv.innerHTML = '';

            cursos.forEach(curso => {
                const cursoElemento = document.createElement('div');
                cursoElemento.innerHTML = `
                    <h3>${curso.titulo}</h3>
                    <p>Instructor: ${curso.instructor}</p>
                    <p>${curso.descripcion}</p>
                    <a href="aula.html?id=${curso.id}">Ver curso</a>
                    <hr>
                `;
                listaDiv.appendChild(cursoElemento);
            });
        }
        cargarCursos();

        document.getElementById('formRegistro').addEventListener('submit', async function(e){
            e.preventDefault();
            const nombre = document.getElementById('nombre').value;
            const correo = document.getElementById('correo').value;
            const res = await fetch('/api/registro', {
                method:'POST',
                headers:{'Content-Type':'application/json'},
                body: JSON.stringify({nombre, correo})
            });
            const data = await res.json();
            alert(data.message || data.error);
            this.reset();
        });

        document.getElementById('formAsistencia').addEventListener('submit', async function(e){
            e.preventDefault();
            const correo = document.getElementById('correoAsistencia').value;
            const res = await fetch('/api/asistencia',{
                method:'POST',
                headers:{'Content-Type':'application/json'},
                body: JSON.stringify({correo})
            });
            const data = await res.json();
            alert(data.message || data.error);
            this.reset();
        });

        document.getElementById('formPagos').addEventListener('submit', async function(e){
            e.preventDefault();
            const correo = document.getElementById('correoPago').value;
            const metodo = document.getElementById('metodoPago').value;
            const res = await fetch('/api/pagos',{
                method:'POST',
                headers:{'Content-Type':'application/json'},
                body: JSON.stringify({correo, metodo})
            });
            const data = await res.json();
            alert(data.message || data.error);
            this.reset();
        });
    </script>
</body>
</html>
